{
  "company": "Twitter",
  "title": "Twitter",
  "xmlUrl": "https://blog.twitter.com/engineering/feed",
  "htmlUrl": "https://blog.twitter.com/engineering",
  "content": "\n\n\n\n\nTwitter's Recommendation Algorithm\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nEngineering\n\n\n\n\n\nBack\n\n\n\n\n\nEngineering\n\n\n\nInsights\n\n\n\n\nInfrastructure\n\n\n\n\nOpen source\n\n\n\n\n\n\nSign Up\n\n\n\n\n\n\n\n\n\nSign Up\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nOpen source\nTwitter's Recommendation Algorithm\n\n\n\n            By\n            \n  \n  \n\n\n\n\nFriday, 31 March 2023\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nLink copied successfully\n\n\n\n\n\n\n\n\n\nTwitter aims to deliver you the best of what\u00e2\u0080\u0099s happening in the world right now. This requires a recommendation algorithm to distill the roughly 500 million Tweets posted daily down to a handful of top Tweets that ultimately show up on your device\u00e2\u0080\u0099s For You timeline. This blog is an introduction to how the algorithm selects Tweets for your timeline.\nOur recommendation system is composed of many interconnected services and jobs, which we will detail in this post. While there are many areas of the app where Tweets are recommended\u00e2\u0080\u0094Search, Explore, Ads\u00e2\u0080\u0094this post will focus on the home timeline\u00e2\u0080\u0099s For You\u00c2\u00a0feed.\nHow do we choose Tweets?\nThe foundation of Twitter\u00e2\u0080\u0099s recommendations is a set of core models and features that extract latent information from Tweet, user, and engagement data. These models aim to answer important questions about the Twitter network, such as, \u00e2\u0080\u009cWhat is the probability you will interact with another user in the future?\u00e2\u0080\u009d or, \u00e2\u0080\u009cWhat are the communities on Twitter and what are trending Tweets within them?\u00e2\u0080\u009d Answering these questions accurately enables Twitter to deliver more relevant recommendations.\nThe recommendation pipeline is made up of three main stages that consume these features:\u00c2\u00a0\n\nFetch the best Tweets from different recommendation sources in a process called candidate sourcing.\nRank each Tweet using a machine learning model.\nApply heuristics and filters, such as filtering out Tweets from users you\u00e2\u0080\u0099ve blocked, NSFW content, and Tweets you\u00e2\u0080\u0099ve already seen.\n\nThe service that is responsible for constructing and serving the For You timeline is called Home Mixer. Home Mixer is built on Product Mixer, our custom Scala framework that facilitates building feeds of content. This service acts as the software backbone that connects different candidate sources, scoring functions, heuristics, and filters.\nThis diagram below illustrates the major components used to construct a timeline:\nThis Tweet is unavailable\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n          This Tweet is unavailable.\n        \n\n\n\n\n\n\n\n\n\n\n\n\n\nLet\u00e2\u0080\u0099s explore the key parts of this system, roughly in the order they\u00e2\u0080\u0099d be called during a single timeline request, starting with retrieving candidates from Candidate Sources.\nCandidate Sources\nTwitter has several Candidate Sources that we use to retrieve recent and relevant Tweets for a user. For each request, we attempt to extract the best 1500 Tweets from a pool of hundreds of millions through these sources. We find candidates from people you follow (In-Network) and from people you don\u00e2\u0080\u0099t follow (Out-of-Network). Today, the For You timeline consists of 50% In-Network Tweets and 50% Out-of-Network Tweets on average, though this may vary from user to user.\nIn-Network Source\nThe In-Network source is the largest candidate source and aims to deliver the most relevant, recent Tweets from users you follow. It efficiently ranks Tweets of those you follow based on their relevance using a logistic regression model. The top Tweets are then sent to the next stage.\nThe most important component in ranking In-Network Tweets is Real Graph. Real Graph is a model which predicts the likelihood of engagement between two users. The higher the Real Graph score between you and the author of the Tweet, the more of their tweets we'll include.\nThe In-Network source has been the subject of recent work at Twitter. We recently stopped using Fanout Service, a 12-year old service that was previously used to provide In-Network Tweets from a cache of Tweets for each user. We\u00e2\u0080\u0099re also in the process of redesigning the logistic regression ranking model which was last updated and trained several years ago!\nOut-of-Network Sources\nFinding relevant Tweets outside of a user\u00e2\u0080\u0099s network is a trickier problem: How can we tell if a certain Tweet will be relevant to you if you don\u00e2\u0080\u0099t follow the author? Twitter takes two approaches to addressing this.\nSocial Graph\nOur first approach is to estimate what you would find relevant by analyzing the engagements of people you follow or those with similar interests.\nWe traverse the graph of engagements and follows to answer the following questions:\n\nWhat Tweets did the people I follow recently engage with?\nWho likes similar Tweets to me, and what else have they recently liked?\n\nWe generate candidate Tweets based on the answers to these questions and rank the resulting Tweets using a logistic regression model. Graph traversals of this type are essential to our Out-of-Network recommendations; we developed GraphJet, a graph processing engine that maintains a real-time interaction graph between users and Tweets, to execute these traversals. While such heuristics for searching the Twitter engagement and follow network have proven useful (these currently serve about 15% of Home Timeline Tweets), embedding space approaches have become the larger source of Out-of-Network Tweets.\nEmbedding Spaces\nEmbedding space approaches aim to answer a more general question about content similarity: What Tweets and Users are similar to my interests?\nEmbeddings work by generating numerical representations of users\u00e2\u0080\u0099 interests and Tweets\u00e2\u0080\u0099 content. We can then calculate the similarity between any two users, Tweets or user-Tweet pairs in this embedding space. Provided we generate accurate embeddings, we can use this similarity as a stand-in for relevance.\nOne of Twitter\u00e2\u0080\u0099s most useful embedding spaces is SimClusters. SimClusters discover communities anchored by a cluster of influential users using a custom matrix factorization algorithm. There are 145k communities, which are updated every three weeks. Users and Tweets are represented in the space of communities, and can belong to multiple communities. Communities range in size from a few thousand users for individual friend groups, to hundreds of millions of users for news or pop culture. These are some of the biggest communities:\nThis Tweet is unavailable\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n          This Tweet is unavailable.\n        \n\n\n\n\n\n\n\n\n\n\n\n\n\nWe can embed Tweets into these communities by looking at the current popularity of a Tweet in each community. The more that users from a community like a Tweet, the more that Tweet will be associated with that community.\nRanking\nThe goal of the For You timeline is to serve you relevant Tweets. At this point in the pipeline, we have ~1500 candidates that may be relevant. Scoring directly predicts the relevance of each candidate Tweet and is the primary signal for ranking Tweets on your timeline. At this stage, all candidates are treated equally, without regard for what candidate source it originated from.\nRanking is achieved with a ~48M parameter neural network that is continuously trained on Tweet interactions to optimize for positive engagement (e.g. Likes, Retweets, and Replies). This ranking mechanism takes into account thousands of features and outputs ten labels to give each Tweet a score, where each label represents the probability of an engagement. We rank the Tweets from these scores.\u00c2\u00a0\nHeuristics, Filters, and Product Features\nAfter the Ranking stage, we apply heuristics and filters to implement various product features. These features work together to create a balanced and diverse feed. Some examples include:\n\nVisibility Filtering: Filter out Tweets based on their content and your preferences. For instance, remove Tweets from accounts you block or mute. \u00c2\u00a0\nAuthor Diversity: Avoid too many consecutive Tweets from a single author.\nContent Balance: Ensure we are delivering a fair balance of In-Network and Out-of-Network Tweets.\nFeedback-based Fatigue: Lower the score of certain Tweets if the viewer has provided negative feedback around it.\nSocial Proof: Exclude Out-of-Network Tweets without a second degree connection to the Tweet as a quality safeguard. In other words, ensure someone you follow engaged with the Tweet or follows the Tweet\u00e2\u0080\u0099s author.\nConversations:\u00c2\u00a0Provide more context to a Reply by threading it together with the original Tweet.\nEdited Tweets:\u00c2\u00a0Determine if the Tweets currently on a device are stale, and send instructions to replace them with the edited versions.\n\nMixing and Serving\nAt this point, Home Mixer has a set of Tweets ready to send to your device. As the last step in the process, the system blends together Tweets with other non-Tweet content like Ads, Follow Recommendations, and Onboarding prompts, which are returned to your device to display.\u00c2\u00a0\nThe pipeline above runs approximately 5 billion times per day and completes in under 1.5 seconds on average. A single pipeline execution requires 220 seconds of CPU time, nearly 150x the latency you perceive on the app.\nThis Tweet is unavailable\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n          This Tweet is unavailable.\n        \n\n\n\n\n\n\n\n\n\n\n\n\n\nThe goal of our open source endeavor is to provide full transparency to you, our users, about how our systems work. We\u00e2\u0080\u0099ve released the code powering our recommendations that you can view here\u00c2\u00a0(and here) to understand our algorithm in greater detail, and we are also working on several features to provide you greater transparency within our app. Some of the new developments we have planned include:\u00c2\u00a0\n\nA better Twitter analytics platform for creators with more information on reach and engagement\nGreater transparency into any safety labels applied to your Tweets or accounts\nGreater visibility into why Tweets appear on your timeline\n\nWhat\u00e2\u0080\u0099s Next?\nTwitter is the center of conversations around the world. Every day, we serve over 150 billion Tweets to people\u00e2\u0080\u0099s devices. Ensuring that we\u00e2\u0080\u0099re delivering the best content possible to our users is both a challenging and an exciting problem. We\u00e2\u0080\u0099re working on new opportunities to expand our recommendation systems\u00e2\u0080\u0094new real-time features, embeddings, and user representations\u00e2\u0080\u0094and we have one of the most interesting datasets and user bases in the world to do it with. We are building the town square of the future. If this interests you, please consider joining us.\nWritten by the Twitter Team.\nThis Tweet is unavailable\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n          This Tweet is unavailable.\n        \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTweet\nTwitter logo icon\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTags:\n\n\nopen source\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nLink copied successfully\n\n\n\n\n\n\n\n\n\n\n\nMore from Open source\n\n\nHunting a Linux kernel bug\n\n\n              By\n              \n  \n  \n\n\n            \n              and\n              \n  \n  \n\n\n            \n            on Monday, 27 April 2020\n          \n\n\nIntroducing Rezolus\n\n\n              By\n              \n  \n  \n\n\n            \n            on Monday, 19 August 2019\n          \n\n\nIntroducing Vireo: a lightweight and versatile video processing library\n\n\n              By\n              \n  \n  \n\n\n            \n            on Friday, 15 December 2017\n          \n\n\nIntroducing Serial: improved data serialization on Android\n\n\n              By\n              \n  \n  \n\n\n            \n            on Monday, 6 November 2017\n          \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n          X platform\n\n          \n\n\n\n\n\nX.com\n\nStatus\n\nAccessibility\n\nEmbed a post\n\nPrivacy Center\n\nTransparency Center\n\nDownload the X app\n\n\n\n\n          X Corp.\n\n          \n\n\n\n\n\nAbout the company\n\nCompany news\n\nBrand toolkit\n\nJobs and internships\n\nInvestors\n\n\n\n\n          Help\n\n          \n\n\n\n\n\nHelp Center\n\nUsing X\n\nX for creators\n\nAds Help Center\n\nManaging your account\n\nEmail Preference Center\n\nRules and policies\n\nContact us\n\n\n\n\n          Developer resources\n\n          \n\n\n\n\n\nDeveloper home\n\nDocumentation\n\nForums\n\nCommunities\n\nDeveloper blog\n\nEngineering blog\n\nDeveloper terms\n\n\n\n\n          Business resources\n\n          \n\n\n\n\n\nAdvertise\n\nX for business\n\nResources and guides\n\nX for marketers\n\nMarketing insights\n\nBrand inspiration\n\nX Ads Academy\n\n\n\n\n\n\u200e\u00a9 2024 X Corp.\u200e\n\n\nCookies\n\n\nPrivacy\n\n\nTerms and conditions\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nDid someone say \u00e2\u0080\u00a6 cookies?\n\n  X and its partners use cookies to provide you with a better, safer and\n  faster service and to support our business. Some cookies are necessary to use\n  our services, improve our services, and make sure they work properly.\n  Show more about your choices.\n\n\n          \n\n\n\n\n\n                  Accept all cookies\n              \n\n\n\n                  Refuse non-essential cookies\n              \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
  "latestPost": {
    "title": "Twitter's Recommendation Algorithm",
    "title_detail": {
      "type": "text/plain",
      "language": null,
      "base": "https://blog.twitter.com/content/blog-twitter/engineering/en_us",
      "value": "Twitter's Recommendation Algorithm"
    },
    "links": [
      {
        "rel": "alternate",
        "type": "text/html",
        "href": "https://blog.twitter.com/engineering/en_us/topics/open-source/2023/twitter-recommendation-algorithm"
      }
    ],
    "link": "https://blog.twitter.com/engineering/en_us/topics/open-source/2023/twitter-recommendation-algorithm",
    "summary": "Twitter aims to deliver you the best of what\u2019s happening in the world right now. This blog is an introduction to how the algorithm selects Tweets for your timeline.",
    "summary_detail": {
      "type": "text/html",
      "language": null,
      "base": "https://blog.twitter.com/content/blog-twitter/engineering/en_us",
      "value": "Twitter aims to deliver you the best of what\u2019s happening in the world right now. This blog is an introduction to how the algorithm selects Tweets for your timeline."
    },
    "published": "",
    "published_parsed": null,
    "id": "https://blog.twitter.com/engineering/en_us/topics/open-source/2023/twitter-recommendation-algorithm",
    "guidislink": false
  }
}